# Сервисы

В распределенных системах процессы (или объекты и компоненты) взаимодействуют друг с другом для выполнения некоторой полезной деятельности, например для поддержки чат-сессии. Каждый из процессов в таком взаимодействии играет определенную роль. Ниже описаны три архитектурных стиля: клиент-сервер, пиринговые системы и сервисно-ориентированная архитектура.

**Сервис** — термин, использующийся для обозначения отдельной части компьютерной системы, управляющей набором связанных ресурсов и представляющей их функциональность пользователям и приложениям. Например, доступ к разделяемому файлу осуществляется через файловый сервис, а покупка товаров производится через электронный платежный сервис. Доступ к сервису возможен только через экспортируемый набор операций. Например, для файлового сервиса такими операциями могли бы быть _read_, _write_ и _delete_.

Тот факт, что сервис обеспечивает доступ к ресурсу путем предоставления строго определенного набора операций, есть часть стандартной программной инженерной практики. Но это также отражает и физическую организацию распределенной системы. Ресурсы в распределенной системе физически инкапсулированы и могут быть доступны другим узлам только посредством коммуникаций. Для эффективного разделения каждый ресурс должен управляться специальной программой, которая предоставляет интерфейс к ресурсу, делая ресурс доступным, а его модификацию безопасной и _консистентной_.



### Клиент-сервер

В основе коллективного взаимодействия всегда лежит двухточечная связь. Технология связи двух узлов может служить структурным эле- ментом масштабируемой архитектуры, а также решать частные задачи. Если связь выходит за рамки однократной посылки сообщения (например, при удаленной аутентификации или RPC), то принято обсуждать ее в понятиях клиентов, запрашивающих службы у серверов. Сервер — процесс, реализующий некоторую службу.

Клиент — процесс, запрашивающий службу у сервера путем посыл- ки запроса, ожидания и получения ответа.

Термин «сервер», вероятно, хорошо знаком большинству читателей. Он относится к исполняемой программе (процессу) на сетевом компьютере, который принимает запросы от программ, работающих на других компьютерах, чтобы выполнять обслуживание этих запросов и отвечать подходящим образом. Запрашивающие процессы называются клиентами, а подход в целом называется клиент-серверным взаимодействием.

При данном подходе запросы и отклики посылаются в виде сообще- ний. Когда клиент посылает запрос на операцию, которую нужно вы- полнить, мы говорим, что клиент делает вызов (invoke) операции на сервере. Полное взаимодействие между клиентами и серверами с точки зрения клиента называется удаленным вызовом (remote invocation).

Процесс, аналогичный описанному, может происходить и на серве- ре, и на клиенте, так как сервер иногда вызывает операции на других серверах. Термины «клиент» и «сервер» применяются только к ролям, исполняемым в ходе отдельного запроса. Клиенты активны (делают запрос) и серверы пассивны (просыпаются при поступлении запроса); серверы работают непрерывно, тогда как клиенты — нет.

Заметим, что по умолчанию термины «клиент» и «сервер» относятся к процессу, а не к узлу, на котором они работают, но в повседневном общении эти термины относят также к узлам, компьютерам. Другое уточнение, которое мы обсудим в главе 3, связано с тем, что ресурсы могут быть инкапсулированы в виде серверных объектов, а доступ к ним про- исходит со стороны клиентских объектов. В этом случае мы говорим о том, что клиентский объект вызывает метод серверного объекта.

<figure><img src="../../.gitbook/assets/Снимок экрана 2024-05-16 в 09.03.24.png" alt="" width="563"><figcaption></figcaption></figure>

Хотя модель клиент-сервер является двухточечной и не учитывает потенциального параллелизма приложения, она весьма популярна, осо- бенно в коммерческих приложениях.

Ее принципиальная ценность заключается в простоте реализации и в возможности декомпозиции большой задачи на ряд подзадач, ко- торые могут быть выполнены параллельно и независимо друг от друга. Разбиение на подзадачи требует аккуратности и зависит от специфики приложения. Так, например, в системах управления базами данных выделяют три функциональных слоя: пользовательский интерфейс; слой обработки данных; слой хранения данных.

Эти слои могут быть разнесены по разным узлам, что порождает множество вариантов реализации. При этом могут возникать «тонкие» и «толстые» в зависимости от объема функционирующего ПО клиенты и серверы.

В тех случаях, когда серверы, в свою очередь, выступают в роли клиентов, возникают так называемые многозвенные архитектуры, где цепочка вовлеченных в обработку транзакции серверов располагается на разных узлах. Подобная организация распределенной обработки носит название _вертикального распределения_. Альтернативный способ организации, когда клиент и сервер содержат физически разделенные части одного модуля, носит название _горизонтального распределения_.&#x20;



### Одноранговые сети

Очень часто распределенные приложения могут функционировать без выделенного сервера. Для этого достаточно на каждом узле запустить несложное приложение, после чего они могут обмениваться сообщениями. В таких случаях говорят об _одноранговой_ или _пиринговой_ (_peer-to-peer_, P2P) архитектуре. При этом все узлы равны и играют симметричную роль в вычислениях, в отличие от модели клиент-сервер, где роли узлов существенно асимметричны, а серверы являются централизованными компонентами. Подобная сеть может легко самоорганизовываться и может иметь регулярную структуру, но может и не иметь таковой. Важной особенностью пиринговых сетей является их способность масштабироваться, т. е. создавать большие комбинированные хранилища данных и мощные вычислительные системы.

Примеры таких систем — eMule, BitTorrent, популярные файлообменные системы, позволяющие распределять информацию между большими группами компьютеров.



### Сервисно-ориентированная архитектура

Модель клиент-сервер перестает быть адекватной, когда надо организовать доступ к глобальным ресурсам масштабируемой системы. В условиях слабой связи между узлами предпочтительным подходом к построению масштабируемой системы считается _сервисно-ориентированная архитектура_\[1], когда компоненты системы реализованы в виде модульных сервисов (служб) с четко определенным интерфейсом, которые могут быть найдены и использованы клиентами.

Абстракция изолированного сервиса помогает установить правильные отношения между самой службой, ее средой и ее потребителями. Особенно важно выделять в отдельные службы операции чтения и записи и масштабировать каждую из них по отдельности. Для каждой службы могут существовать свои приемы оптимизации производительности.

На клиентской стороне устанавливается свой набор служб, которые позволяют, например, связаться с сервисами регистрации и найти сервис, который удовлетворяет потребностям клиента.

Взаимодействующие программные компоненты имеют минимальные знания друг о друге: они находят информацию, которая им нужна для взаимодействия, непосредственно перед взаимодействием, вызывая методы обнаружения сервисов, после чего обращаются к самим сервисам. Сервис может базироваться на любом сервере, а при необходимости — перемещен. Главное, что должно соблюдаться при его перемещении — это то, что запись о новом месторасположении должна соответствовать его фактическому новому местопребыванию. Пока ссылка на этот сервис есть в службе регистрации, предполагаемые клиенты будут в состоянии найти и использовать его.

Сервисы могут быть реализованы как несколько серверных процессов на отдельных узлах, взаимодействующих с целью предоставления необходимого сервиса клиенту.

Сервисно-ориентированная архитектура — абстрактная концепция, которая может быть реализована с использованием различных технологий, включая распределенные объекты и компоненты, а также вебсервисы. Ее главным достоинством является гибкость, возможность адаптации к изменяющимся условиям, что обусловлено наличием слабой связи между сервисами.



